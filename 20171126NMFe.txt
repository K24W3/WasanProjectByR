setwd("F:/wasan_vec/output_data")
wa <- read.csv("vectors4.csv")
X=as(wa,"matrix")
library(NMF)
res.nmf <- nmf(X,7,'lee',seed=71)
 w <- basis(res.nmf)
 h<-coef(res.nmf)
 X.nmf<- w %*% h
img_num<-c(001,002,003,004,005,006,007,008,009,011,012,013,014,015,018,020,021,022,023,024,025,026,027,028,029,031,032,033,034,035,037,038,039,040,041,042,043,044,045,046,047,048,049,050,051,052,053,057,058,061,062,063,064,065,066,067,068,069,070,071,072,073,074,075,076,078,079,081,082,083,084,085,086,087,088,089,090,091,092,093,094,095,096,098,099,100,101,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,135,136,137,138,139,140,141,142,143,144,145,148,149,150,151,152,153,155,158,159,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,194,195,197)
rownames(w)<-img_num
r<-round(w*100,0)
stars(r[1:20,],key.loc=c(14,2),main="NMF results 1-20",full=FALSE)
numCL=7
km<-kmeans(w,numCL)
result <- km$cluster #クラスタリング結果の抽出
img_num[result==1]

r<-round(dist(w)*1000,0)

s <- read.csv("nmf_sorted.csv")
ss<-s[,2:6]
rownames(ss)<-s[,1]
stars(ss[1:20,],key.loc=c(14,2),main="NMF results 1-20",full=FALSE)


%%% NEW %%%

#wa <- read.csv("vectors4.csv")
wa <- read.csv("vectors6.csv")
X=as(wa,"matrix")
library(NMF)
res.nmf <- nmf(X,3,'lee',seed=71)
 w <- basis(res.nmf)
 img_num<-c(001,002,003,004,005,006,007,008,009,011,012,013,014,015,018,020,021,022,023,024,025,026,027,028,029,031,032,033,034,035,037,038,039,040,041,042,043,044,045,046,047,048,049,050,051,052,053,057,058,061,062,063,064,065,066,067,068,069,070,071,072,073,074,075,076,078,079,081,082,083,084,085,086,087,088,089,090,091,092,093,094,095,096,098,099,100,101,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,135,136,137,138,139,140,141,142,143,144,145,148,149,150,151,152,153,155,158,159,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,194,195,197)
rownames(w)<-img_num
library(rgl)
 plot3d(x,y,z,type="s",col="green")

xs<-round(x*150,1)
ys<-round(y*100,1)
zs<-round(z*100,1)
 plot3d(xs,ys,zs,type="s",col="green")
round(w*100,0)
w

